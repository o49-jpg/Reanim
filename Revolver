--// Top-Right Revolver Selector with Weapon Icons (Mobile + PC)
--// FULL REPLACEMENT SCRIPT

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer

-- ScreenGui
local gui = Instance.new("ScreenGui")
gui.Name = "RevolverUI"
gui.IgnoreGuiInset = true
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

-- Root container (top-right)
local root = Instance.new("Frame")
root.Size = UDim2.fromOffset(260, 120)
root.Position = UDim2.fromScale(1, 0)
root.AnchorPoint = Vector2.new(1, 0)
root.BackgroundTransparency = 1
root.Parent = gui

-- Local positions (left, center, right)
local positions = {
	UDim2.fromOffset(40, 60),   -- left
	UDim2.fromOffset(130, 60),  -- center
	UDim2.fromOffset(220, 60),  -- right
}

-- Weapon icons (logical order: left, center, right)
local weaponIcons = {
	"rbxassetid://18883333362", -- Mirage Edge (Left)
	"rbxassetid://18840242444", -- Yamato (Center)
	"rbxassetid://18840418547", -- Beowulf (Right)
}

-- Circle creator
local function createCircle(iconId)
	local button = Instance.new("TextButton")
	button.Size = UDim2.fromOffset(54, 54)
	button.AnchorPoint = Vector2.new(0.5, 0.5)
	button.BackgroundColor3 = Color3.fromRGB(22, 22, 22)
	button.Text = ""
	button.AutoButtonColor = false

	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(1, 0)
	corner.Parent = button

	local stroke = Instance.new("UIStroke")
	stroke.Color = Color3.fromRGB(90, 90, 90)
	stroke.Transparency = 0.35
	stroke.Parent = button

	local image = Instance.new("ImageLabel")
	image.Size = UDim2.fromScale(0.85, 0.85)
	image.Position = UDim2.fromScale(0.5, 0.5)
	image.AnchorPoint = Vector2.new(0.5, 0.5)
	image.BackgroundTransparency = 1
	image.Image = iconId
	image.ScaleType = Enum.ScaleType.Fit
	image.Parent = button

	return button
end

-- Create circles
local circles = {
	createCircle(weaponIcons[1]),
	createCircle(weaponIcons[2]),
	createCircle(weaponIcons[3]),
}

for _, c in ipairs(circles) do
	c.Parent = root
end

-- Revolver state
local centerIndex = 2
local busy = false
local tweenInfo = TweenInfo.new(0.28, Enum.EasingStyle.Quint, Enum.EasingDirection.Out)

-- Update visuals
local function update()
	busy = true

	for i, circle in ipairs(circles) do
		local offset = i - centerIndex
		if offset < -1 then offset += 3 end
		if offset > 1 then offset -= 3 end

		local pos = positions[offset + 2]
		local size = offset == 0 and 72 or 54
		local alpha = offset == 0 and 0 or 0.35

		TweenService:Create(circle, tweenInfo, {
			Position = pos,
			Size = UDim2.fromOffset(size, size),
			BackgroundTransparency = alpha
		}):Play()
	end

	task.delay(tweenInfo.Time, function()
		busy = false
	end)
end

-- Rotate visually correct for top-right
local function rotateVisual(dir)
	if busy then return end

	centerIndex -= dir
	if centerIndex > 3 then centerIndex = 1 end
	if centerIndex < 1 then centerIndex = 3 end

	update()
end

-- Keyboard input
UserInputService.InputBegan:Connect(function(input, gpe)
	if gpe then return end

	if input.KeyCode == Enum.KeyCode.Right then
		rotateVisual(1)
	elseif input.KeyCode == Enum.KeyCode.Left then
		rotateVisual(-1)
	end
end)

-- Touch input (center circle only)
local function getCenterCircle()
	return circles[centerIndex]
end

for _, circle in ipairs(circles) do
	circle.InputBegan:Connect(function(input)
		if input.UserInputType ~= Enum.UserInputType.Touch then return end

		local center = getCenterCircle()
		if circle ~= center then return end

		local localX = input.Position.X - center.AbsolutePosition.X
		local width = center.AbsoluteSize.X
		local deadZone = width * 0.2

		if localX < (width / 2 - deadZone) then
			rotateVisual(-1)
		elseif localX > (width / 2 + deadZone) then
			rotateVisual(1)
		end
	end)
end

-- Initial draw
update()
